import { useEffect, useState } from 'react';
import { logger, isWeb } from "../../../utils";
import { UIEventType } from "../../../types";
import { usePersistCallback } from "../../../hooks";
import { InputType } from '../type';
export const useAudioMessageHandle = (chatInputProps, options) => {
    const { onAudioRecording, frameEventTarget } = chatInputProps;
    const { inputType } = options;
    const [isAudioInputFocusing, setIsAudioInputFocusing] = useState(false);
    const isRealAudioInputFocusing = inputType === InputType.Voice && isAudioInputFocusing;
    const [isRecording, setIsRecording] = useState(false);
    const onRecording = usePersistCallback((isRecordingNew) => {
        setIsRecording(isRecordingNew);
        onAudioRecording === null || onAudioRecording === void 0 ? void 0 : onAudioRecording(isRecordingNew);
    });
    useEffect(() => {
        logger.debug('useAudioMessageHandle listen focus and blur', {
            isWeb,
            frameEventTarget,
        });
        if (isWeb && frameEventTarget) {
            const onFocus = () => {
                logger.debug('useAudioMessageHandle focus in');
                setIsAudioInputFocusing(true);
            };
            const onBlur = () => {
                logger.debug('useAudioMessageHandle blur in');
                setIsAudioInputFocusing(false);
            };
            frameEventTarget.on(UIEventType.FrameFocus, onFocus);
            frameEventTarget.on(UIEventType.FrameBlur, onBlur);
            frameEventTarget.trigger(UIEventType.TriggerFocus);
            return () => {
                frameEventTarget.off(UIEventType.FrameFocus, onFocus);
                frameEventTarget.off(UIEventType.FrameBlur, onBlur);
            };
        }
    }, []);
    return {
        isRecording,
        isRealAudioInputFocusing,
        onRecording,
    };
};
//# sourceMappingURL=use-audio-message-handle.js.map