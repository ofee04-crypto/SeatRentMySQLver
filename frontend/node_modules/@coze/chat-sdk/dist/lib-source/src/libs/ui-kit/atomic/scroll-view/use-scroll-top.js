import { useEffect, useRef, useState } from 'react';
import { isWeb, logger } from "../../../utils";
import { usePersistCallback } from "../../../hooks";
export const useScrollTop = () => {
    const [scrollTop, setScrollTop] = useState(0);
    const refSetScrollTimeout = useRef(undefined);
    const refScrollEl = useRef(null);
    const scrollToTop = usePersistCallback((top) => {
        if (isWeb) {
            setScrollTop(0 - Math.abs(top));
        }
        else {
            setScrollTop(Math.abs(top));
        }
    });
    const delayToSetScroll = usePersistCallback((scrollTopNum, timeoutNumber = 0) => {
        if (refSetScrollTimeout.current) {
            clearTimeout(refSetScrollTimeout.current);
        }
        if (timeoutNumber <= 0) {
            scrollToTop(scrollTopNum);
            return;
        }
        else {
            refSetScrollTimeout.current = setTimeout(() => {
                scrollToTop(scrollTopNum);
            }, timeoutNumber);
        }
    });
    const scrollToAnchorBottom = usePersistCallback(() => {
        if (scrollTop !== 0) {
            delayToSetScroll(0);
        }
        else {
            delayToSetScroll(1);
            // 先设置1居于底部，然后设置为0， 锚定在底部
            // 由于scrollTop为0，如果直接设置为0，不能出发锚定。
            delayToSetScroll(0, 200);
        }
    });
    const onInitScrollEl = usePersistCallback((el) => {
        refScrollEl.current = el;
    });
    useEffect(() => () => {
        if (refSetScrollTimeout.current) {
            clearTimeout(refSetScrollTimeout.current);
        }
    }, []);
    logger.debug('useScrollTop', { scrollTop });
    return {
        scrollTop,
        scrollToTop,
        delayToSetScroll,
        scrollToAnchorBottom,
        onInitScrollEl,
        refScrollEl,
    };
};
//# sourceMappingURL=use-scroll-top.js.map