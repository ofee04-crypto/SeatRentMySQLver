import { useMemo } from 'react';
import { useUpdateEffect } from "../../../hooks";
import { InputType } from '../type';
const useTaskMessage = (chatInputProps, options) => {
    let isShowTaskMessage = false;
    const { inputType, setInputType, isRecording } = options;
    const { taskList, isNeedTaskMessage = false } = chatInputProps;
    const taskOptions = useMemo(() => {
        const taskOptionTemp = [];
        taskList === null || taskList === void 0 ? void 0 : taskList.map(item => {
            taskOptionTemp.push(...(item.taskValue || []));
        });
        return taskOptionTemp.filter(item => !!item);
    }, [taskList]);
    // Task messages are only visible in text mode.
    if (taskOptions.length > 0 &&
        inputType === InputType.Text &&
        isNeedTaskMessage) {
        isShowTaskMessage = true;
    }
    //Updates the type of the input box to text when the task list changes.(Except audio is recording)
    useUpdateEffect(() => {
        // 当taskList有变化的时候，判断是否需要修改inputType
        if (!isRecording && inputType !== InputType.Text && isNeedTaskMessage) {
            setInputType === null || setInputType === void 0 ? void 0 : setInputType(InputType.Text);
        }
    }, [taskList]);
    return {
        isShowTaskMessage,
        taskOptions,
    };
};
export const useMultiModeMessageHandle = (chatInputProps, options) => {
    const { isShowTaskMessage, taskOptions } = useTaskMessage(chatInputProps, options);
    const isShowMultiModeMessage = isShowTaskMessage; // We will continue to add more multi messages。
    return {
        taskMessage: {
            isShow: isShowTaskMessage,
            options: taskOptions,
        },
        isShowMultiModeMessage,
    };
};
//# sourceMappingURL=use-multi-mode-message-handle.js.map